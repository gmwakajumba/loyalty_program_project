SELECT customer.customer_id, rental_date::date, COUNT (*) AS same_day_purchases
  FROM customer
  JOIN rental ON customer.customer_id = rental.customer_id
  JOIN inventory ON rental.inventory_id = inventory.inventory_id
  JOIN film ON inventory.film_id = film.film_id
  WHERE customer.customer_id IN (
148,526,
178,137,
144,459,
181,410,
236,403,
522,469,
470,373,
259,468,
462,372,
187,550,
176,532,
75,209,
21,26,
86,211,
346,366,
50,360,
348,513,
454,347,
390,267,
257,39,
78,362,
363,119,
368,66,
237,29,87,
80,439,
558,494,
576,591,
467,479,
120,210,
204,15,5,
349,404,172,
197,265,
533,380,
472,13,
46,125,
3,7,273,
502,342,
566,112,
560,102,
168,484,
103,242,
84,196,
221,448,
141,520,
38,200,
146,206,
436,108,
114,426,
482,295,
147,354
)
GROUP BY customer.customer_id, rental_date::date
ORDER BY customer.customer_id, rental_date
